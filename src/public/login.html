<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Login</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        font-size: 22px;
        margin: 0;
        background-color: #f4f6f9;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
      }

      .login-card {
        background-color: #fff;
        padding: 40px;
        border: 1px solid #ddd;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
        width: 100%;
        max-width: 400px;
        text-align: center;
      }

      /* Added some spacing for the logo */
      .login-logo {
        height: 80px;
        width: auto;
        margin-bottom: 20px;
      }

      .login-card h2 {
        margin-bottom: 25px;
        font-size: 1.8rem;
        font-weight: bold;
        color: #333;
      }

      .login-card form {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .login-card input[type="email"],
      .login-card input[type="password"] {
        padding: 12px;
        font-size: 1rem;
        border-radius: 6px;
        border: 1px solid #ccc;
        outline: none;
      }

      .login-card button {
        padding: 12px;
        font-size: 1rem;
        background-color: #0d6efd;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .login-card button:hover {
        background-color: #0b5ed7;
      }

      /* Warning box style */
      .warning-box {
        background-color: #fff3cd;
        color: #856404;
        border: 1px solid #ffeeba;
        padding: 15px;
        margin-top: 20px;
        font-size: 0.9rem;
        border-radius: 6px;
        text-align: left;
      }

      .error-msg {
        color: red;
        font-size: 0.9rem;
      }
    </style>
  </head>
  <body>
    <div class="login-card">
      <!-- SECI Logo added here -->
      <img
        src="https://www.seci.co.in/frontend/assets/images/seci-logo.png"
        alt="SECI Logo"
        class="login-logo"
      />

      <h2>Projects Dashboard</h2>
      <form id="loginForm">
        <input value="admin@seci.co.in" type="email" name="email" placeholder="Email address" required />
        <input
          type="password"
          name="password"
          value="admin1234"
          placeholder="Password"
          required
        />
        <button type="submit">Login</button>

        <!-- Warning box added below the form fields -->
        <div class="warning-box">
          <strong>Warning:</strong> If after login you see that the portal is in
          "TESTING" mode, kindly do not make changes as they will not be saved.
          Data shown may also be different from the actual data.
        </div>
      </form>

      <script>
        document
          .getElementById("loginForm")
          .addEventListener("submit", async (e) => {
            e.preventDefault();

            const form = e.target;
            const formData = new FormData(form);
            const email = formData.get("email");
            const password = formData.get("password");

            try {
              const response = await fetch("/api/auth/login", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({ email, password }),
              });

              if (response.ok) {
                const response_json = await response.json();

                // ✅ Store token in localStorage
                jwt_token = response_json.login_token;
                app_environment = response_json.app_environment;
                localStorage.setItem("token", jwt_token);
                localStorage.setItem("app_environment", app_environment);

                // ✅ Redirect to home page
                window.location.href = "/home.html";
              } else {
                alert("Login failed");
              }
            } catch (err) {
              console.error("Login error:", err);
              alert("Something went wrong");
            }
          });
      </script>
    </div>
  </body>
</html>
